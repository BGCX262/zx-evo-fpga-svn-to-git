;---------------------------------------DRVRE   DB #E0;MASTER (#F0 SLAVE);---------------------------------------COMAH   LD BC,#F0:OUT A:RETREADY   LD BC,#F0:IN A:RLCA:RET NC        JR READYWAITDRQ LD BC,#F0:IN A:AND 8:RET NZ        JR WAITDRQ;---------------------------------------PROZ    PUSH DE        LD A,(HL):INC HL        LD E,(HL):INC HL        LD D,(HL):INC HL        LD H,(HL),L,A;DE,cyl H,head L,sec        LD A,H:CP #FF:JR Z,POT        AND %00001111:LD H,A        LD A,(DRVRE)        OR H        LD BC,#FFD0:OUT A        LD C,#70:OUT L        LD C,#B0:OUT D        LD C,#90:OUT E        POP HL        LD A,1:OR A        RET;-------POT     POP HL        RET;---------------------------------------RDDSEne ;i:HL(4) - Sector number;             DE - Address        CALL PROZ:RET Z        LD BC,#50,A,1:OUT A        LD A,#20:CALL COMAH,READY        CALL WAITDRQ        CALL READS        CALL READY        LD A,1:OR A        RET;---------------------------------------SDDSEne ;i:HL(4) - Sector number;             DE - Address        CALL PROZ:RET Z        LD BC,#50,A,1:OUT A        LD A,#30:CALL COMAH,READY        CALL WAITDRQ        CALL SAVDS        CALL READY        LD A,1:OR A        RET;---------------------------------------;READ 512b from IDE Device BUFFERREADS   LD C,#10,D,8RD1.64     INI        DEC D:JP NZ,RD1        RET;---------------------------------------;SAVE 512b to IDE Device BUFFERSAVDS   LD C,#10,D,8SV1.64     OUTI        DEC D:JP NZ,SV1        RET;---------------------------------------